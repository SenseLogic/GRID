// -- IMPORTS

#include "audio.h"

// -- CONSTANTS

const UINT_16
    NoteFrequencyArray440Hz[ 96 ] =
    {
        // C      C#       D       D#      E       F       F#      G       G#      A       A#      H
        0x0115, 0x0125, 0x0137, 0x0149, 0x015D, 0x0172, 0x0188, 0x019F, 0x01B8, 0x01D2, 0x01EE, 0x020B,
        0x022A, 0x024B, 0x026E, 0x0293, 0x02BA, 0x02E4, 0x030F, 0x033E, 0x036F, 0x03A4, 0x03DB, 0x0416,
        0x0454, 0x0496, 0x04DC, 0x0526, 0x0574, 0x05C7, 0x061F, 0x067C, 0x06DF, 0x0747, 0x07B6, 0x082C,
        0x08A8, 0x092C, 0x09B7, 0x0A4B, 0x0AE8, 0x0B8E, 0x0C3E, 0x0CF8, 0x0DBE, 0x0E8F, 0x0F6C, 0x1057,
        0x1150, 0x1258, 0x136F, 0x1497, 0x15D0, 0x171C, 0x187C, 0x19F0, 0x1B7B, 0x1D1E, 0x1ED9, 0x20AF,
        0x22A0, 0x24AF, 0x26DE, 0x292D, 0x2BA0, 0x2E38, 0x30F8, 0x33E1, 0x36F7, 0x3A3B, 0x3DB2, 0x415D,
        0x4540, 0x495E, 0x4DBB, 0x525A, 0x5740, 0x5C70, 0x61EF, 0x67C2, 0x6DED, 0x7477, 0x7B64, 0x82BA,
        0x8A80, 0x92BC, 0x9B76, 0xA4B5, 0xAE80, 0xB8E0, 0xC3DE, 0xCF84, 0xDBDB, 0xE8EE, 0xF6C7, 0x10574
    },
    NoteFrequencyArray435Hz[ 96 ] =
    {
        0x0112, 0x0122, 0x0134, 0x0146, 0x0159, 0x016E, 0x0183, 0x019B, 0x01B3, 0x01CD, 0x01E8, 0x0205,
        0x0224, 0x0245, 0x0267, 0x028C, 0x02B2, 0x02DB, 0x0307, 0x0335, 0x0366, 0x039A, 0x03D0, 0x040A,
        0x0448, 0x0489, 0x04CE, 0x0517, 0x0565, 0x05B7, 0x060E, 0x066A, 0x06CC, 0x0733, 0x07A1, 0x0815,
        0x0890, 0x0912, 0x099C, 0x0A2F, 0x0ACA, 0x0B6E, 0x0C1C, 0x0CD4, 0x0D98, 0x0E66, 0x0F42, 0x102A,
        0x1120, 0x1225, 0x1339, 0x145D, 0x1593, 0x16DC, 0x1838, 0x19A9, 0x1B2F, 0x1CCD, 0x1E83, 0x2054,
        0x2240, 0x2449, 0x2672, 0x28BB, 0x2B27, 0x2DB8, 0x3070, 0x3351, 0x365E, 0x399A, 0x3D07, 0x40A8,
        0x4480, 0x4893, 0x4CE3, 0x5176, 0x564E, 0x5B70, 0x60E0, 0x66A2, 0x6CBD, 0x7334, 0x7A0E, 0x8150,
        0x8900, 0x9125, 0x99C7, 0xA2EC, 0xAC9C, 0xB6E0, 0xC1BF, 0xCD45, 0xD979, 0xE668, 0xF41B, 0x1029F
    };

// -- FUNCTIONS

void InitializeSounds(
    )
{
    InitializeChannels( 15 );
}

// ~~

void PlaySound(
    UINT_8 channel_index,
    UINT_16 frequency,
    UINT_8 random_bit_count,
    UINT_16 pulse,
    UINT_8 waveform,
    UINT_8 attack_decay,
    UINT_8 sustain_release
    )
{
    UINT_8
        channel_offset;

    if ( random_bit_count != 0 )
    {
        frequency += GetRandomInteger( random_bit_count );
    }

    channel_offset = channel_index * 0x07;
    PlayChannel( channel_offset, frequency, pulse, waveform, attack_decay, sustain_release );
}

// ~~

void PlayNote(
    UINT_8 channel_index,
    INT_8 note_index,
    UINT_16 pulse,
    UINT_8 waveform,
    UINT_8 attack_decay,
    UINT_8 sustain_release
    )
{
    UINT_8
        channel_offset;
    UINT_16
        frequency;

    if ( note_index >= 0 )
    {
        frequency = NoteFrequencyArray440Hz[ note_index ];
        channel_offset = channel_index * 0x07;
        PlayChannel( channel_offset, frequency, pulse, waveform, attack_decay, sustain_release );
    }
}

// ~~

void PlayShotSound(
    )
{
    PlaySound( 2, 0x2200, 10, 0x1200, 0x80, 0x2D, 0x02 );
}

// ~~

void PlayImpactSound(
    )
{
    PlaySound( 2, 0x1400, 9, 0x0000, 0x80, 0x2D, 0x02 );
}

// ~~

void PlayExplosionSound(
    )
{
    PlaySound( 2, 0x0400, 9, 0x0000, 0x80, 0x2D, 0x02 );
}

// ~~

void PlayDefeatSound(
    )
{
    PlayNote( 0, 38, 0x0800, 0x20, 0x2D, 0x02 );
    PlayNote( 1, 41, 0x0800, 0x20, 0x2D, 0x02 );
    PlayNote( 2, 45, 0x0800, 0x20, 0x2D, 0x02 );
}

// ~~

inline void PlayVictorySound(
    )
{
    PlayNote( 0, 48, 0x0800, 0x20, 0x2D, 0x02 );
    PlayNote( 1, 52, 0x0800, 0x20, 0x2D, 0x02 );
    PlayNote( 2, 55, 0x0800, 0x20, 0x2D, 0x02 );
}
