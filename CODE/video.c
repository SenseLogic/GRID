// -- IMPORTS

#include "base.h"
#include "memory.h"
#include "video.h"

// -- CONSTANTS

const UINT_8
    FontByteArray[ 384 ] =
        {
            0b00000000, 0b00000000, 0b00000000, 0b00000000,
            0b10101010, 0b00000000, 0b00100010, 0b00000000,
            0b00010101, 0b00010101, 0b00000000, 0b00000000,
            0b01110100, 0b01010100, 0b00000111, 0b00000101,
            0b10011110, 0b00000100, 0b00101100, 0b00000101,
            0b10100001, 0b00000101, 0b00010110, 0b00010000,
            0b10010110, 0b00010100, 0b00110110, 0b11010110,
            0b00100010, 0b00000101, 0b00000000, 0b00000000,
            0b01011000, 0b00000001, 0b00001001, 0b00010000,
            0b00001001, 0b01010000, 0b00011000, 0b00000001,
            0b11100100, 0b01000100, 0b00000110, 0b00000100,
            0b11101000, 0b01000000, 0b00001010, 0b00000000,
            0b00000000, 0b00000000, 0b10001000, 0b00010100,
            0b11000000, 0b01000000, 0b00000000, 0b00000000,
            0b00000000, 0b00000000, 0b00101000, 0b00000000,
            0b10100000, 0b00000101, 0b00010110, 0b00000000,
            0b11110110, 0b01010100, 0b00100101, 0b00000101,
            0b10101110, 0b00000000, 0b00111010, 0b00010000,
            0b10000110, 0b00010100, 0b00110110, 0b00010000,
            0b10000110, 0b00010100, 0b00100100, 0b00000101,
            0b11010100, 0b01010101, 0b00000000, 0b00010101,
            0b00110111, 0b01000001, 0b00100100, 0b00000101,
            0b11010110, 0b00000100, 0b00100101, 0b00000101,
            0b10000011, 0b00010101, 0b00010110, 0b00000000,
            0b10010110, 0b00010100, 0b00100101, 0b00000101,
            0b10010110, 0b01010100, 0b00100100, 0b00000101,
            0b00101000, 0b00000000, 0b00101000, 0b00000000,
            0b00101000, 0b00000000, 0b01101000, 0b00000000,
            0b01100000, 0b00000110, 0b00000010, 0b00100100,
            0b00110000, 0b00010000, 0b00000011, 0b00000001,
            0b00001001, 0b10010000, 0b00011000, 0b00000001,
            0b10000110, 0b00010100, 0b00100010, 0b00000000,
            0b11010110, 0b01010100, 0b00100111, 0b00010001,
            0b00110000, 0b01000000, 0b00100110, 0b00010101,
            0b01110101, 0b01000000, 0b00110101, 0b00000101,
            0b01100000, 0b01000000, 0b00100101, 0b00000100,
            0b01100000, 0b01010101, 0b00100101, 0b00010101,
            0b01100000, 0b01000000, 0b00100111, 0b00010001,
            0b11101000, 0b01000001, 0b00101010, 0b00000000,
            0b01100000, 0b01010000, 0b11001001, 0b00010101,
            0b01110101, 0b01000000, 0b00010101, 0b00010101,
            0b10110010, 0b00000000, 0b00101010, 0b00000000,
            0b00000000, 0b01010001, 0b10010000, 0b00010101,
            0b01010101, 0b01010000, 0b00010111, 0b00010100,
            0b10101011, 0b00000000, 0b00111010, 0b00010000,
            0b11010000, 0b01010000, 0b00010111, 0b00010101,
            0b01110000, 0b01000000, 0b00010101, 0b00010101,
            0b01100000, 0b01000000, 0b00100101, 0b00000101,
            0b01110000, 0b01000000, 0b01011101, 0b00000001,
            0b01100000, 0b01010000, 0b00001001, 0b11010101,
            0b01110000, 0b01000000, 0b00010101, 0b00000000,
            0b01100000, 0b00010000, 0b00110010, 0b00000100,
            0b10111000, 0b00010000, 0b00001010, 0b00010000,
            0b01010000, 0b01010000, 0b00100101, 0b00010101,
            0b01010000, 0b01010000, 0b00101001, 0b00000001,
            0b01010000, 0b01010000, 0b00011111, 0b00010101,
            0b01010000, 0b01010000, 0b00010110, 0b00010100,
            0b01010000, 0b01010000, 0b11001001, 0b00010101,
            0b00110000, 0b01010000, 0b00110110, 0b00010000,
            0b10101010, 0b00000001, 0b00101010, 0b00010000,
            0b10010100, 0b00000000, 0b00000010, 0b00010100,
            0b00000010, 0b01010101, 0b00100000, 0b00010101,
            0b01111000, 0b01010000, 0b00000000, 0b00000000,
            0b00000000, 0b00000000, 0b11000000, 0b11000000,
            0b00001010, 0b00010001, 0b00000000, 0b00000000,
            0b11010110, 0b01010100, 0b00010101, 0b00010101,
            0b11010111, 0b00010100, 0b00110101, 0b00000101,
            0b01010110, 0b00000100, 0b00100101, 0b00000100,
            0b01010111, 0b01010100, 0b00110101, 0b00000101,
            0b11010111, 0b00000001, 0b00110101, 0b00010000,
            0b11010111, 0b00000001, 0b00010101, 0b00000000,
            0b11010110, 0b01000100, 0b00100101, 0b00000101,
            0b11010101, 0b01010101, 0b00010101, 0b00010101,
            0b10101011, 0b00000001, 0b00111010, 0b00010000,
            0b00000000, 0b01010101, 0b00100100, 0b00000101,
            0b11110101, 0b00000101, 0b00010101, 0b00010101,
            0b01010101, 0b00000000, 0b00110101, 0b00010000,
            0b11111101, 0b01010101, 0b00010101, 0b00010101,
            0b11110100, 0b01010101, 0b00010111, 0b00010101,
            0b01010111, 0b01010101, 0b00110101, 0b00010101,
            0b11010111, 0b00010100, 0b00010101, 0b00000000,
            0b01010110, 0b01010100, 0b00100101, 0b01000101,
            0b11010111, 0b00010100, 0b00010101, 0b00010101,
            0b10010110, 0b00000100, 0b00100100, 0b00000101,
            0b10101011, 0b00000001, 0b00101010, 0b00000000,
            0b01010101, 0b01010101, 0b00110101, 0b00010101,
            0b01010101, 0b01010101, 0b00101001, 0b00000001,
            0b01010101, 0b01010101, 0b00011111, 0b00010101,
            0b10110101, 0b00010101, 0b00010111, 0b00010101,
            0b10010101, 0b00010101, 0b00101010, 0b00000000,
            0b10100011, 0b00000101, 0b00110110, 0b00010000,
            0b01101000, 0b00000001, 0b00001010, 0b00010000,
            0b00101010, 0b00000000, 0b00101010, 0b00000000,
            0b00101001, 0b01000000, 0b00011010, 0b00000000,
            0b00000110, 0b00000110, 0b00000000, 0b00000000,
            0b10100000, 0b00000000, 0b00110101, 0b00010101
        };

// -- FUNCTIONS

void ClearScreen(
    )
{
    UINT_8
        *screen_byte,
        *post_screen_byte;

    screen_byte = ( UINT_8 * )ScreenAddress;
    post_screen_byte = screen_byte + ScreenByteCount;

    while ( screen_byte != post_screen_byte )
    {
        *screen_byte++ = 0;
    }
}

// ~~

void InitializeFont(
    )
{
    UINT_8
        bit_index,
        *font_byte,
        left_bit,
        right_bit,
        row_byte;
    UINT_16
        character_index;

    font_byte = ( UINT_8 * )FontAddress;

    for ( character_index = 0;
          character_index < 256;
          ++character_index )
    {
        for ( bit_index = 0;
              bit_index < 8;
              bit_index += 2 )
        {
            left_bit = character_index & ( 1 << ( bit_index ) );
            right_bit = character_index & ( 1 << ( bit_index + 1 ) );
            row_byte = ( left_bit ? 0xF0 : 0 ) + ( right_bit ? 0x0F : 0 );
            *font_byte++ = row_byte;
            *font_byte++ = row_byte;
        }
    }

    SetBankAddress( BankAddress );
    SetScreenAddress( ScreenAddress );
    SetFontAddress( FontAddress );
}
